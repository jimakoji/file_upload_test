<script type="text/javascript">
  //<![CDATA[
    $(function(){
        $('#upload').click(function() {
                              $('#spinner, .link').toggle();                           
                              $('body').css({'cursor': 'wait'});
        });
    });
//]]>
</script>

<%= form_for(@attachment, :html => {:multipart => true}) do |f| %>
  <% if @attachment.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@attachment.errors.count, "error") %> prohibited this attachment from being saved:</h2>

      <ul>
      <% @attachment.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :name %><br />
    <%= f.text_field :name %>
  </div>

<% if @attachment.name != nil %>
  <%= "新しい添付ファイルを選択してください" %>
  <%= "現在の添付ファイル名は#{@attachment.filename}です" %>
<% end %>
  <div class="field">
    <%= f.label :content %><br />
    <%= f.file_field :content %>
  </div>

  <div class="actions">
    <%#= f.submit "Upload", "onClick" => "$('#spinner, #loading').toggle();$('body').css('cursor', 'url(/assets/loading.gif)')" %>
    <%= f.submit "Upload", disable_with: 'uploading...',  id: 'upload' %>
    <%= image_tag "loading.gif", :id=>'spinner', :style => 'display:none;' %>
  </div>
<% end %>

